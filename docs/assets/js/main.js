"use strict";let savedSeries=[],favoriteShows=[];const input=document.querySelector(".js-input");function handleFunction(e){e.preventDefault();const t=getFavoritesFromLocalStorage();null===t?searchSeries():(favoriteShows=t,showFavs(),showData(),searchSeries())}function setFavoritesinLocalStorage(){localStorage.setItem("Favorite shows",JSON.stringify(favoriteShows))}function getFavoritesFromLocalStorage(){return JSON.parse(localStorage.getItem("Favorite shows"))}function searchSeries(){const e=input.value;return fetch(`http://api.tvmaze.com/search/shows?q=${e}`).then(e=>e.json()).then(e=>{saveData(e=formatData(e)),showData()})}function formatData(e){let t=[];for(let o=0;o<e.length;o++)null===e[o].show.image?t.push({name:e[o].show.name,image:"https://via.placeholder.com/210x295/ffffff/666666/?text=No%20Photo",id:e[o].show.id}):t.push({name:e[o].show.name,image:e[o].show.image.medium,id:e[o].show.id});return t}function saveData(e){savedSeries=e}function showData(){const e=document.querySelector(".js-series_section");let t="";for(let e=0;e<savedSeries.length;e++)t+=`<div class="serie_element ${getFavoriteClassName(e)}" data-id="${savedSeries[e].id}"><p class="show_title">${savedSeries[e].name}</p><img class="show_image" src="${savedSeries[e].image}" /></div>`;e.innerHTML=t,listenShow()}function getFavoriteClassName(e){return isThisShowFav(savedSeries[e].id)?"show-item--fav":""}function listenShow(){const e=document.querySelectorAll(".serie_element");for(const t of e)t.addEventListener("click",favClick)}function favClick(e){const t=showClicked(e);isThisShowFav(t)?removeFromFavorites(t):addToFavorites(t),showData()}function showClicked(e){const t=e.currentTarget;return parseInt(t.dataset.id)}function addToFavorites(e){for(const t of savedSeries)t.id===e&&favoriteShows.push(t);console.log("Added to favorites:",favoriteShows),showFavs()}function removeFromFavorites(e){for(let t=0;t<favoriteShows.length;t++)favoriteShows[t].id===e&&favoriteShows.splice(t,1);showFavs(),console.log("Remove from favorites array >> Favorites:",favoriteShows)}function isThisShowFav(e){for(const t of favoriteShows)if(t.id===e)return!0;return!1}function showFavs(){const e=document.querySelector(".js-fav_list");let t="";for(let e=0;e<favoriteShows.length;e++)t+=`<li class="favorite_element" data-index="${e}", data-id"${favoriteShows[e].id}"><div class="title_fav"><p class="show_title">${favoriteShows[e].name}</p><button class="btn__remove-favorite">X</button></div><img class="fav_img" src="${favoriteShows[e].image}" /></li>`;e.innerHTML=t,setFavoritesinLocalStorage()}function startApp(){let e=JSON.parse(localStorage.getItem("Favorite shows"));null!==e&&(favoriteShows=e,showFavs())}startApp();const btn=document.querySelector(".js-btn");btn.addEventListener("click",handleFunction);